<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>SQL | 小明的博客</title><meta name="keywords" content="数据分析,SQL,数据库"><meta name="author" content="可不"><meta name="copyright" content="可不"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#e68ab8"><meta name="description" content="关系型数据库的命名是因为数据库展现了表单形式的不同类型数据之间的关系。 SQL是结构化数据查询语言，是我们用来像数据管理系统（Data Management system）下达指令时用到的. Sqlite是一个轻量的DBMS。 SQL SQL既不是一个API也不是一种协议，而是一种声明式语言，只需要告诉它做什么即可。 它是关系型数据库的通用语言。SQL查询是客户端发送给数据库服务器的文本字符串，">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL">
<meta property="og:url" content="https://kebuaaa.github.io/SQL/index.html">
<meta property="og:site_name" content="小明的博客">
<meta property="og:description" content="关系型数据库的命名是因为数据库展现了表单形式的不同类型数据之间的关系。 SQL是结构化数据查询语言，是我们用来像数据管理系统（Data Management system）下达指令时用到的. Sqlite是一个轻量的DBMS。 SQL SQL既不是一个API也不是一种协议，而是一种声明式语言，只需要告诉它做什么即可。 它是关系型数据库的通用语言。SQL查询是客户端发送给数据库服务器的文本字符串，">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600">
<meta property="article:published_time" content="2022-03-26T02:34:00.000Z">
<meta property="article:modified_time" content="2022-07-13T02:41:59.433Z">
<meta property="article:author" content="可不">
<meta property="article:tag" content="数据分析">
<meta property="article:tag" content="SQL">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600"><link rel="shortcut icon" href="../img/favicon.png"><link rel="canonical" href="https://kebuaaa.github.io/SQL/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="../css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQL',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-07-13 10:41:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#e68ab8')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><style>#article-container.post-content h1:before, h2:before, h3:before, h4:before, h5:before, h6:before { -webkit-animation: avatar_turn_around 1s linear infinite; -moz-animation: avatar_turn_around 1s linear infinite; -o-animation: avatar_turn_around 1s linear infinite; -ms-animation: avatar_turn_around 1s linear infinite; animation: avatar_turn_around 1s linear infinite; }</style><link rel="stylesheet" href="/css/touming.css"><meta name="generator" content="Hexo 5.4.2"><link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="../img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="../archives/"><div class="headline">文章</div><div class="length-num">95</div></a><a href="../tags/"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/"><div class="headline">分类</div><div class="length-num">20</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="../index.html"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> 存档</span></a></div><div class="menus_item"><a class="site-page" href="../tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="../link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="../wallpaper/"><i class="fa-fw fas fa-image fa-fw"></i><span> 相册</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600')"><nav id="nav"><span id="blog_name"><a id="site-name" href="../index.html">小明的博客</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="../index.html"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="../archives/"><i class="fa-fw fas fa-archive"></i><span> 存档</span></a></div><div class="menus_item"><a class="site-page" href="../tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="../categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="../link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="../about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="../wallpaper/"><i class="fa-fw fas fa-image fa-fw"></i><span> 相册</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-03-26T02:34:00.000Z" title="发表于 2022-03-26 10:34:00">2022-03-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-07-13T02:41:59.433Z" title="更新于 2022-07-13 10:41:59">2022-07-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="../categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SQL"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="../md_imgs/SQL/0.png" alt="SQL语法速成手册 (1).png"><br>
关系型数据库的命名是因为数据库展现了表单形式的不同类型数据之间的关系。<br>
SQL是结构化数据查询语言，是我们用来像数据管理系统（Data Management system）下达指令时用到的.<br>
Sqlite是一个轻量的DBMS。</p>
<h1>SQL</h1>
<p>SQL既不是一个API也不是一种协议，而是一种声明式语言，只需要告诉它做什么即可。<br>
它是关系型数据库的通用语言。SQL查询是客户端发送给数据库服务器的文本字符串，指<br>
明需要执行的具体操作。</p>
<ul>
<li>
<p>SQL is everywhere</p>
</li>
<li>
<p>SQL enables us to pull data from many sources</p>
</li>
</ul>
<p>SQL语句的三种类型：</p>
<ul>
<li>
<p>DDL（Data Definition Language，数据定义语言）：处理用户、数据库以及表单的创建、删除、约束和权限等</p>
</li>
<li>
<p>DML（Data Manipulation Language，数据操纵语言） 用来查询或者变更表中的记录。</p>
</li>
<li>
<p>DCL（Data Control Language，数据控制语言） 用来确认或者取消对数据库中的数据进行的变更。除此之外，还可以对 RDBMS 的用户是否有权限操作数据库中的对象（数据库表等）进行设定。DCL 包含以下几种指令。</p>
<ul>
<li>
<p>COMMIT ： 确认对数据库中的数据进行的变更</p>
</li>
<li>
<p>ROLLBACK ： 取消对数据库中的数据进行的变更</p>
</li>
<li>
<p>GRANT ： 赋予用户操作权限</p>
</li>
<li>
<p>REVOKE ： 取消用户的操作权限</p>
</li>
</ul>
</li>
</ul>
<p>基本的DDL命令</p>
<table>
<thead>
<tr>
<th>创建数据库</th>
<th><strong>CREATE</strong> DATEBASE dbname</th>
</tr>
</thead>
<tbody>
<tr>
<td>选择当前数据库</td>
<td>USE dbname</td>
</tr>
<tr>
<td>删除数据库以及表单</td>
<td><strong>DROP</strong> DATABASE dbname</td>
</tr>
<tr>
<td>创建表单（）</td>
<td>CREATE TABLE tbname （col defs）</td>
</tr>
<tr>
<td>删除表单</td>
<td>DROP TABLE tbname</td>
</tr>
<tr>
<td>删除表单中的所有行</td>
<td>TRUNCATE TABLE tbname</td>
</tr>
<tr>
<td>修改数据库和表的结构</td>
<td><strong>ALTER</strong></td>
</tr>
</tbody>
</table>
<p>DML命令</p>
<table>
<thead>
<tr>
<th>增加行</th>
<th>INSERT INTO tbname VALUES（）</th>
</tr>
</thead>
<tbody>
<tr>
<td>增加行的部分内容</td>
<td>INSERT INTO user(col_name) VALUES（）</td>
</tr>
<tr>
<td>（限制返回2-5行）查询所有行和所有列</td>
<td>SELECT * FROM tbname（LIMIT 2,5）</td>
</tr>
<tr>
<td>选择部分行和部分列</td>
<td>SELECT col_name FROM tbname  WHERE condition</td>
</tr>
<tr>
<td>修改一列的部分行</td>
<td>UPDATE tbname SET col_name=value WHERE condition</td>
</tr>
<tr>
<td>删除部分行</td>
<td>DELETE FROM tbname WHERE condition</td>
</tr>
<tr>
<td>查询部分（不重复）</td>
<td>SELECT DISTINCT</td>
</tr>
<tr>
<td>限制显示的行数</td>
<td>limit 3</td>
</tr>
<tr>
<td>查询表长</td>
<td>count(*)避免缺失值的影响</td>
</tr>
<tr>
<td>查询值命名</td>
<td>AS<br />列名可以紧跟在列后边，加一个’’（提倡）<br />#SElECT SUM(Total) ‘Total Students’ FROM recent_grads<br />名称有空格也要加’’<br />#SELECT SUM(Total) AS ‘Total Students’ FROM recent_grads<br /></td>
</tr>
</tbody>
</table>
<p>列名也可以用数字代替（表的索引）</p>
<h1>基本书写规则</h1>
<ul>
<li>
<p>语句以；结束</p>
</li>
<li>
<p>不区分关键字的大小写，插入表中的数据除外</p>
</li>
<li>
<p>win系统不区分表名和字段名的大小写</p>
</li>
<li>
<p>linux/mac区分</p>
</li>
</ul>
<h2 id="表的创建">表的创建</h2>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">CREATE TABLE <span class="token operator">&lt;</span> 表名 <span class="token operator">></span>
<span class="token punctuation">(</span> <span class="token operator">&lt;</span> 列名 <span class="token number">1</span><span class="token operator">></span> <span class="token operator">&lt;</span> 数据类型 <span class="token operator">></span> <span class="token operator">&lt;</span> 该列所需约束 <span class="token operator">></span> <span class="token punctuation">,</span>
  <span class="token operator">&lt;</span> 列名 <span class="token number">2</span><span class="token operator">></span> <span class="token operator">&lt;</span> 数据类型 <span class="token operator">></span> <span class="token operator">&lt;</span> 该列所需约束 <span class="token operator">></span> <span class="token punctuation">,</span>
  <span class="token operator">&lt;</span> 列名 <span class="token number">3</span><span class="token operator">></span> <span class="token operator">&lt;</span> 数据类型 <span class="token operator">></span> <span class="token operator">&lt;</span> 该列所需约束 <span class="token operator">></span> <span class="token punctuation">,</span>
  <span class="token operator">&lt;</span> 列名 <span class="token number">4</span><span class="token operator">></span> <span class="token operator">&lt;</span> 数据类型 <span class="token operator">></span> <span class="token operator">&lt;</span> 该列所需约束 <span class="token operator">></span> <span class="token punctuation">,</span>
  <span class="token punctuation">.</span>
  <span class="token punctuation">.</span>
  <span class="token punctuation">.</span>
  <span class="token operator">&lt;</span> 该表的约束 <span class="token number">1</span><span class="token operator">></span> <span class="token punctuation">,</span> <span class="token operator">&lt;</span> 该表的约束 <span class="token number">2</span><span class="token operator">></span> <span class="token punctuation">,</span>……<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>约束条件主要分为两种：</p>
<ul>
<li>
<p>非空约束：NOT NULL</p>
</li>
<li>
<p>主键约束:PRIMARY KEY</p>
</li>
<li>
<p>默认值约束：DEFAULT</p>
</li>
</ul>
<p>数据类型：</p>
<ul>
<li>
<p>INTEGER</p>
</li>
<li>
<p>CHAR</p>
</li>
<li>
<p>VARCHAR</p>
</li>
<li>
<p>DATE</p>
</li>
</ul>
<h2 id="表的删除和更新">表的删除和更新</h2>
<h3 id="表的删除：">表的删除：</h3>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">DROP TABLE <span class="token operator">&lt;</span>表名<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="表的修改-alter-table-：">表的修改（ALTER TABLE）：</h3>
<p>ALTER TABLE和DROP TABLE一样会删除整张表，但是ALTER TABLE可以进行列的增删<br>
添加列：<code>**ALTER** **TABLE** **&lt;** 表名 **&gt;** ADD COLUMN **&lt;** 列的定义 **&gt;**</code><br>
<strong>删除列：</strong><code>**ALTER** **TABLE** **&lt;** 表名 **&gt;** **DROP** COLUMN **&lt;** 列名 **&gt;**;</code></p>
<h3 id="表的清空">表的清空</h3>
<p><code>TRUNCATE **TABLE** TABLE_NAME;</code><br>
优点：相比drop/delete，truncate用来清除数据时，速度最快。</p>
<h3 id="插入数据">插入数据</h3>
<p><code>**INSERT** **INTO** **&lt;**表名**&gt;** (列1, 列2, 列3, ……) **VALUES** (值1, 值2, 值3, ……); </code><br>
对表进行全列 INSERT 时，可以省略表名后的列清单。这时 VALUES子句的值会默认按照从左到右的顺序赋给每一列。<br>
很多RDBMS也支持同时插入多行数据：</p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token comment">-- Oracle中的多行INSERT</span>
<span class="token keyword">INSERT</span> <span class="token keyword">ALL</span> <span class="token keyword">INTO</span> productins <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'0002'</span><span class="token punctuation">,</span> <span class="token string">'打孔器'</span><span class="token punctuation">,</span> <span class="token string">'办公用品'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token string">'2009-09-11'</span><span class="token punctuation">)</span>
<span class="token keyword">INTO</span> productins <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'0003'</span><span class="token punctuation">,</span> <span class="token string">'运动T恤'</span><span class="token punctuation">,</span> <span class="token string">'衣服'</span><span class="token punctuation">,</span> <span class="token number">4000</span><span class="token punctuation">,</span> <span class="token number">2800</span><span class="token punctuation">,</span> <span class="token keyword">NULL</span><span class="token punctuation">)</span>
<span class="token keyword">INTO</span> productins <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'0004'</span><span class="token punctuation">,</span> <span class="token string">'菜刀'</span><span class="token punctuation">,</span> <span class="token string">'厨房用具'</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">2800</span><span class="token punctuation">,</span> <span class="token string">'2009-09-20'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="数据的更新">数据的更新</h3>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">UPDATE</span> <span class="token operator">&lt;</span>表名<span class="token operator">></span>
<span class="token keyword">SET</span> <span class="token operator">&lt;</span>列名<span class="token operator">></span> <span class="token operator">=</span> <span class="token operator">&lt;</span>表达式<span class="token operator">></span> <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>列名<span class="token number">2</span><span class="token operator">>=</span><span class="token operator">&lt;</span>表达式<span class="token number">2</span><span class="token operator">></span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token keyword">WHERE</span> <span class="token operator">&lt;</span>条件<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment">-- 可选，非常重要。</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> 子句<span class="token punctuation">;</span>  <span class="token comment">--可选</span>
<span class="token keyword">LIMIT</span> 子句<span class="token punctuation">;</span> <span class="token comment">--可选</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1>extract data from databases</h1>
<h2 id="数据运算与比较">数据运算与比较</h2>
<h3 id="常用的计算函数">常用的计算函数</h3>
<ul>
<li>
<p>AVG()</p>
</li>
<li>
<p>SUM（col_name,int）</p>
</li>
<li>
<p>ROUND（）:向下取整</p>
</li>
<li>
<p>CAST（col_name AS Float）:整数列转化为实数列</p>
</li>
</ul>
<h3 id="算术运算与比较运算">算术运算与比较运算</h3>
<p><img src="../md_imgs/SQL/1.png" alt="image.png"></p>
<ul>
<li>IN：通常写在where从句中，用于匹配，也可以写进去subquery</li>
</ul>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">SELECT</span> Major_category<span class="token punctuation">,</span> Major
  <span class="token keyword">FROM</span> recent_grads
 <span class="token keyword">WHERE</span> Major_category <span class="token keyword">IN</span> 
 <span class="token punctuation">(</span>
 <span class="token keyword">SELECT</span> Major_category
  <span class="token keyword">FROM</span> recent_grads
 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> Major_category
 <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">SUM</span><span class="token punctuation">(</span>TOTAL<span class="token punctuation">)</span> <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">3</span>
 <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="逻辑运算">逻辑运算</h3>
<p>SQL的逻辑运算并不只是简单的True和False的逻辑运算，因为SQL中可能出现的一种数据值为<code>NULL</code>。这使得SQL的逻辑运算变成了三值逻辑：<br>
<img src="../md_imgs/SQL/2.png" alt="image.png"></p>
<h2 id="字符串函数">字符串函数</h2>
<ul>
<li>
<p>常用的有一个函数是LENGTH()，返回字符串长度</p>
</li>
<li>
<p>还有一个是拼接函数‘||’，‘A||B’表示的是将字符串A和B拼接起来，既可以是列名（文本列）也可以是字符串，但是单引号应用更广泛</p>
</li>
<li>
<p>LOWER()</p>
</li>
</ul>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">SELECT</span> <span class="token string">'Major: '</span><span class="token operator">||</span>LOWER<span class="token punctuation">(</span>Major<span class="token punctuation">)</span> <span class="token keyword">AS</span> Major<span class="token punctuation">,</span>Total<span class="token punctuation">,</span>Men<span class="token punctuation">,</span>Women<span class="token punctuation">,</span>Unemployment_rate<span class="token punctuation">,</span><span class="token keyword">LENGTH</span><span class="token punctuation">(</span>Major<span class="token punctuation">)</span> <span class="token keyword">AS</span> Length_of_name
<span class="token keyword">FROM</span> recent_grads
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Unemployment_rate <span class="token keyword">DESC</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="字符串的模糊匹配-like字句">字符串的模糊匹配（LIKE字句）</h2>
<p>在处理字符串相关的列时，往往会用到like子句：</p>
<ul>
<li>
<p>where进行筛选时，可能会用到模糊匹配</p>
</li>
<li>
<p>CASE创建新的列时，可能会用到like子句</p>
</li>
</ul>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">WHERE</span> <span class="token punctuation">[</span>column_name<span class="token punctuation">]</span> <span class="token keyword">LIKE</span> <span class="token string">"[pattern]"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="../md_imgs/SQL/3.png" alt="image.png"><br>
当然也可以发现直接用列的值进行匹配，因为像是&quot;jen&quot;这样的值不能被匹配，在使用的时候可以考虑加一个lower（）函数</p>
<h2 id="创建新的列">创建新的列</h2>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">CASE</span>
<span class="token keyword">WHEN</span> <span class="token operator">&lt;</span>condition_1<span class="token operator">></span> <span class="token keyword">THEN</span> <span class="token operator">&lt;</span>value_1<span class="token operator">></span>
<span class="token keyword">WHEN</span> <span class="token operator">&lt;</span>condition_2<span class="token operator">></span> <span class="token keyword">THEN</span> <span class="token operator">&lt;</span>value_2<span class="token operator">></span>
<span class="token keyword">ELSE</span> <span class="token operator">&lt;</span>value_3<span class="token operator">></span>
<span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token operator">&lt;</span>new_column_name<span class="token operator">></span>
#如果没有<span class="token keyword">else</span>，未匹配的值会被设为空值


<span class="token keyword">SELECT</span> Major<span class="token punctuation">,</span>Sample_size<span class="token punctuation">,</span>
        <span class="token keyword">CASE</span>
        <span class="token keyword">WHEN</span> Sample_size<span class="token operator">&lt;</span><span class="token number">200</span> <span class="token keyword">THEN</span> <span class="token string">'Small'</span>
        <span class="token keyword">WHEN</span> Sample_size<span class="token operator">>=</span><span class="token number">200</span> <span class="token keyword">and</span> Sample_size<span class="token operator">&lt;</span><span class="token number">1000</span> <span class="token keyword">THEN</span> <span class="token string">'Medium'</span>
        <span class="token keyword">ELSE</span> <span class="token string">'Large'</span>
        <span class="token keyword">END</span> <span class="token keyword">AS</span> <span class="token string">'Sample_category'</span>
<span class="token keyword">FROM</span> recent_grads<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="分组">分组</h2>
<p><img src="../md_imgs/SQL/4.png" alt="image.png"><br>
group by 根据指定的列进行分组，然后对每组进行操作（排序，聚合），将会显示出每一组的最后一个值</p>
<h3 id="提取分组后的部分数据">提取分组后的部分数据</h3>
<p>在sql语句中，运行命令的顺序是：</p>
<ul>
<li>
<p>FROM</p>
</li>
<li>
<p>WHERE</p>
</li>
<li>
<p>GROUP BY</p>
</li>
<li>
<p>HAVING</p>
</li>
<li>
<p>SELECT</p>
</li>
<li>
<p>ORDER BY</p>
</li>
<li>
<p>LIMIT</p>
</li>
</ul>
<p>也就是说，我们无法用where条件句来对GroupBy的结果进行提取，这个时候就引入了having命令（发挥的其实就是where命令的作用）</p>
<h2 id="subquery-complex-and-dynamic-queries">subquery（complex and dynamic queries）</h2>
<blockquote>
<p>A subquery is a query nested within another query.</p>
</blockquote>
<p><strong>子查询可以出现在很多地方（where从句和select从句），但无论在哪都需要加’()'包围起来！</strong><br>
<img src="../md_imgs/SQL/5.png" alt="123.png"></p>
<h3 id="集合运算">集合运算</h3>
<p>每一个子查询可以看成一个table，table与table之间除了可以进行常见的算术运算和逻辑运算以外，SQL还增加了一些table间进行比较的运算符：<br>
<img src="../md_imgs/SQL/6.png" alt="image.png"><br>
例如</p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql">
<span class="token keyword">SQL</span><span class="token operator">:</span> <span class="token keyword">SELECT</span> player_id<span class="token punctuation">,</span> player_name<span class="token punctuation">,</span> height <span class="token keyword">FROM</span> player <span class="token keyword">WHERE</span> height <span class="token operator">></span> <span class="token keyword">ANY</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> height <span class="token keyword">FROM</span> player <span class="token keyword">WHERE</span> team_id <span class="token operator">=</span> <span class="token number">1002</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>可以用来将一个集合的值与另一个集合的所</p>
<h2 id="combining-colums-with-joining">Combining Colums with Joining</h2>
<p><img src="../md_imgs/SQL/7.jpg" alt="456.jpg"><br>
join命令可以用来将数据表联系起来，被联系的数据表既可以是已有的表，也可以是subquery</p>
<h3 id="inner-join">Inner Join</h3>
<p>这个命令主要用来查询两个表中匹配的信息，可以理解为两个表的交集。<br>
<img src="../md_imgs/SQL/8.png" alt="456.png"><br>
The inner join clause is made up of two parts:</p>
<ul>
<li>
<p><code>INNER JOIN</code>, which tells the SQL engine the name of the table you wish to join in your query, and that you wish to use an inner join.</p>
</li>
<li>
<p><code>ON</code>, which tells the SQL engine what columns to use to join the two tables.</p>
</li>
</ul>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> facts <span class="token keyword">AS</span> f
INNER JOIN cities <span class="token keyword">AS</span> <span class="token keyword">c</span> <span class="token keyword">ON</span> <span class="token keyword">c</span><span class="token punctuation">.</span>facts_id <span class="token operator">=</span> f<span class="token punctuation">.</span>id<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="left-join">Left Join</h3>
<blockquote>
<p>A left join includes all the rows that an inner join will select, plus any rows from the first (or left) table that don’t have a match in the second table. We can see this represented as a Venn diagram.</p>
</blockquote>
<p><img src="../md_imgs/SQL/9.png" alt="788.png"><br>
该命令会把b中不匹配的一部分直接置为空值，然后如果需要调用这些不匹配的数据可以使用where从句匹配空值，这时用的是is判断<br>
<img src="../md_imgs/SQL/10.png" alt="565.png"></p>
<h3 id="right-join">RIGHT JOIN</h3>
<p>同时使用多张表时，可能会用到RIGHT JOIN从句<br>
<img src="../md_imgs/SQL/11.png" alt="s.png"></p>
<h3 id="full-join">FULL JOIN</h3>
<blockquote>
<p>The other join type not supported by SQLite is a full outer join. A full outer join will include all rows from the tables on both sides of the join. We can see a full outer join in the Venn diagram below:</p>
</blockquote>
<p><img src="../md_imgs/SQL/12.png" alt="ss.png"></p>
<h3 id="self-join">Self-join</h3>
<p>Self-join 是将同一张表join起来的方法，一般会用做列与列之间有关系的表的查询，而且对这样的join一般只有INNER和LEFT两种方法。以一张既有劳工又有监督者的表格做例子<br>
<img src="../md_imgs/SQL/13.png" alt="images.png"></p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">SELECT</span> e1<span class="token punctuation">.</span>first_name <span class="token operator">||</span><span class="token string">' '</span><span class="token operator">||</span> e1<span class="token punctuation">.</span>last_name employee_name<span class="token punctuation">,</span>e1<span class="token punctuation">.</span>title employee_title<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>first_name <span class="token operator">||</span><span class="token string">" "</span><span class="token operator">||</span>e2<span class="token punctuation">.</span>last_name supervisor_name<span class="token punctuation">,</span>e2<span class="token punctuation">.</span>title supervisor_title
<span class="token keyword">FROM</span> employee e1
LEFT JOIN employee e2 <span class="token keyword">on</span> e1<span class="token punctuation">.</span>reports_to<span class="token operator">=</span>e2<span class="token punctuation">.</span>employee_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> employee_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="joining-for-many-tables">Joining for many tables</h2>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">SELECT</span> <span class="token punctuation">[</span>column_names<span class="token punctuation">]</span> <span class="token keyword">FROM</span> <span class="token punctuation">[</span>table_name_one<span class="token punctuation">]</span>
<span class="token punctuation">[</span>join_type<span class="token punctuation">]</span> JOIN <span class="token punctuation">[</span>table_name_two<span class="token punctuation">]</span> <span class="token keyword">ON</span> <span class="token punctuation">[</span>join_constraint<span class="token punctuation">]</span>
<span class="token punctuation">[</span>join_type<span class="token punctuation">]</span> JOIN <span class="token punctuation">[</span>table_name_three<span class="token punctuation">]</span> <span class="token keyword">ON</span> <span class="token punctuation">[</span>join_constraint<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>The SQL engine interprets joins in order, so the first join will be executed, and then the second join will be executed against the result of the first join. Because of this, we can first build our query in steps:</p>
<ul>
<li>
<p>with 0 joins.</p>
</li>
<li>
<p>with 1 join.</p>
</li>
<li>
<p>with 2 joins.</p>
</li>
</ul>
<h2 id="combining-rows-with-union">Combining Rows with UNION</h2>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token punctuation">[</span>select_statement_one<span class="token punctuation">]</span>
<span class="token keyword">UNION</span>
<span class="token punctuation">[</span>select_statement_two<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>SQL可以通过UNION来实现列拼接，然后需要注意的是拼接前后两个<strong>查询</strong>（表格的合并可以借助select *）同一列的数据类型，int和float是兼容的，但是int和text是不兼容的。<br>
<img src="../md_imgs/SQL/14.png" alt="aa.png"><br>
<img src="../md_imgs/SQL/15.png" alt="image.png"></p>
<h2 id="thinking-in-sql">Thinking in SQL</h2>
<ul>
<li>
<p>Think about what data you need in your final output</p>
</li>
<li>
<p>Work out which tables you’ll need to join, and whether you will need to join to a subquery.</p>
<ul>
<li>If you need to join to a subquery, write the subquery first.</li>
</ul>
</li>
<li>
<p>Then start writing your SELECT clause, followed by the join and any other clauses you will need.</p>
</li>
<li>
<p>Don’t be afraid to write your query in steps, running it as you go— for instance you can run your subquery as a ‘stand alone’ query first to make sure it looks like you want before writing the outer query.</p>
</li>
</ul>
<h2 id="philosophy-of-writting-sql">philosophy of writting SQL</h2>
<p>在sql中大小写和空格是对查询没有影响的</p>
<ul>
<li>
<p>If a select statement has more than one column, put each on a new line, indented from the select statement.</p>
</li>
<li>
<p>Always capitalize SQL function names and keywords</p>
</li>
<li>
<p>Put each clause of your query on a new line.</p>
</li>
<li>
<p>Use indenting to make subqueries appear logically separate.</p>
</li>
<li>
<p>use of alias names and shortcuts</p>
</li>
<li>
<p>换行符可以随便使用但是不要出现空行</p>
</li>
</ul>
<h3 id="指代一个subquery">指代一个subquery</h3>
<blockquote>
<p>Everything in SQL is a table</p>
</blockquote>
<h4 id="with临时指代">with临时指代</h4>
<p>子查询嵌套进查询语句中会降低代码的可读性，SQL提供了WITH方法来对子查询进行一个化名（alias）</p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">WITH</span> <span class="token punctuation">[</span>alias_name<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>subquery<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token punctuation">[</span>main_query<span class="token punctuation">]</span>


<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span>
    <span class="token punctuation">(</span>
     <span class="token keyword">SELECT</span>
         t<span class="token punctuation">.</span><span class="token keyword">name</span><span class="token punctuation">,</span>
         ar<span class="token punctuation">.</span><span class="token keyword">name</span> artist<span class="token punctuation">,</span>
         al<span class="token punctuation">.</span>title album_name<span class="token punctuation">,</span>
         mt<span class="token punctuation">.</span><span class="token keyword">name</span> media_type<span class="token punctuation">,</span>
         g<span class="token punctuation">.</span><span class="token keyword">name</span> genre<span class="token punctuation">,</span>
         t<span class="token punctuation">.</span>milliseconds length_milliseconds
     <span class="token keyword">FROM</span> track t
     INNER JOIN media_type mt <span class="token keyword">ON</span> mt<span class="token punctuation">.</span>media_type_id <span class="token operator">=</span> t<span class="token punctuation">.</span>media_type_id
     INNER JOIN genre g <span class="token keyword">ON</span> g<span class="token punctuation">.</span>genre_id <span class="token operator">=</span> t<span class="token punctuation">.</span>genre_id
     INNER JOIN album al <span class="token keyword">ON</span> al<span class="token punctuation">.</span>album_id <span class="token operator">=</span> t<span class="token punctuation">.</span>album_id
     INNER JOIN artist ar <span class="token keyword">ON</span> ar<span class="token punctuation">.</span>artist_id <span class="token operator">=</span> al<span class="token punctuation">.</span>artist_id
    <span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> album_name <span class="token operator">=</span> <span class="token string">"Jagged Little Pill"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">WITH</span>
    <span class="token punctuation">[</span>alias_name<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>subquery<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>alias_name_2<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>subquery_2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>alias_name_3<span class="token punctuation">]</span> <span class="token keyword">AS</span> <span class="token punctuation">(</span><span class="token punctuation">[</span>subquery_3<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">SELECT</span> <span class="token punctuation">[</span>main_query<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一下子创建多个时每一个是独立的，可以在第二个创建时调用第一个</p>
<h4 id="create-view永久指代">CREATE VIEW永久指代</h4>
<p>我们可以理解为with命令用来定义一个临时的subquery，如果想要永久地定义一个sub，可以使用下列语句：</p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> database<span class="token punctuation">.</span>view_name <span class="token keyword">AS</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> database<span class="token punctuation">.</span><span class="token keyword">table</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>为了防止和其他view冲突，必须要在view_name前边声明database的名称（database_name.view/table_name），在定义的时候使用的任何数据库中的表都要在前边加上database。如果是在本地使用，则不需要写明database。<br>
创建的一个view可以视作一个table，且不能被重写。在使用是也要写成database_name.view_name的形式。</p>
<h1>窗口函数(Online Anallytical Processing)</h1>
<p>SQL中的窗口函数功能很像pandas中的数据透视表所实现的功能，将已有的数据先进行分组然后再以组为单位运用特定的函数来进行操作，一般来说，窗口函数的语法为:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token operator">&lt;</span>窗口函数<span class="token operator">></span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> <span class="token operator">&lt;</span>用于分组的列名<span class="token operator">></span>
                <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token operator">&lt;</span>用于排序的列名<span class="token operator">></span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>以上相当于一个字段，一般跟在<code>select</code>后边实现不同的功能，窗口函数主要分为两种:</p>
<ol>
<li>专用窗口函数，比如rank, dense_rank, row_number等</li>
<li>聚合函数，如sum. avg, count, max, min等</li>
</ol>
<h2 id="和group-order的区别-好处">和group,order的区别(好处)</h2>
<ul>
<li>同时具有分组（partition by）和排序（order by）的功能</li>
<li>窗口函数的操作返回的数据不会删除行(group by)</li>
</ul>
<h1>interact with a SQLite database in Python</h1>
<blockquote>
<p>SQLite is a database that doesn’t require a standalone server; <strong>it stores the entire database as a file on disk</strong>. This makes it ideal for working with larger datasets that can fit on disk but not in memory.</p>
</blockquote>
<p>two ways to :</p>
<ul>
<li>
<p>Sqlite Shell</p>
</li>
<li>
<p>sqlite3</p>
</li>
</ul>
<h2 id="sqlite-shell">Sqlite Shell</h2>
<p>sqlite shell是一个用来和sqlite进行交互的命令行窗口，接下来用它来演示如何进行数据库的创建和修改<br>
Sqlite3 shell 写query的原则：</p>
<ul>
<li>
<p>要打开sqlite shell，需要输入’sqlite3+db_file’</p>
</li>
<li>
<p>换行只表示换行含义，当输入’;'表示输入的query完毕</p>
</li>
<li>
<p>sqlite有许多点命令，可以用来进行全局设置的调整，一般情况下查询结果是不显示列名的，可以通过’.headers on’调整</p>
</li>
<li>
<p>可以通过输入’.mode column’来更改输出格式，保证每一行的列宽相等</p>
</li>
<li>
<p>常用的点命令</p>
<ul>
<li>
<p>.help:显示所有点命令和功能</p>
</li>
<li>
<p>.tables:显示当前数据库的列名</p>
</li>
<li>
<p>.shell [command]:执行命令</p>
</li>
<li>
<p>.quit 退出</p>
</li>
</ul>
</li>
</ul>
<ol>
<li>表的创建</li>
</ol>
<p>在sqlite shell中，表格的创建借助CREATE TABLE命令，格式如下：</p>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>table_name<span class="token punctuation">]</span> <span class="token punctuation">(</span>
  <span class="token punctuation">[</span>column1_name<span class="token punctuation">]</span> <span class="token punctuation">[</span>column1_type<span class="token punctuation">]</span> PRIMARY KEY<span class="token punctuation">,</span>
  <span class="token punctuation">[</span>column2_name<span class="token punctuation">]</span> <span class="token punctuation">[</span>column2_type<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>column3_name<span class="token punctuation">]</span> <span class="token punctuation">[</span>column3_type<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>需要注意的是sqlite支持五种（通用）数据类型：</p>
<ul>
<li>
<p>TEXT</p>
</li>
<li>
<p>INTEGER</p>
</li>
<li>
<p>REAL:DOUBLE+FLOAT</p>
</li>
<li>
<p>NULL</p>
</li>
<li>
<p>BLOB：二进制</p>
</li>
</ul>
<p>可以使用点命令’.schema [tb_name]'查看表格图解<br>
<img src="../md_imgs/SQL/16.png" alt="image.png"></p>
<ol>
<li>表的删除</li>
</ol>
<pre class="line-numbers language-plsql" data-language="plsql"><code class="language-plsql"><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span>table_name<span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="sqlite3">sqlite3</h2>
<p>sqlite3是python中一个用来处理处理关系型数据库的标准库，把数据文件存储在了普通文件中。该模块是在DB-API的基础上建立的，很多地方是一致的。DB-API的主要函数：</p>
<ul>
<li>connect():连接数据库</li>
</ul>
<blockquote>
<p>When we’re connected to a database, SQLite locks the database file and prevents any other processes from connecting to the database simultaneously. The SQLite team designed the module this way to keep the database lightweight and to avoid the complexity of multiple processes interacting with the same database.</p>
</blockquote>
<ul>
<li>
<p>cursor():创建一个cursor对象管理查询，作用</p>
<ul>
<li>
<p>Run a query against the database</p>
</li>
<li>
<p>Parse the results from the database</p>
</li>
<li>
<p>Convert the results to native Python objects</p>
</li>
<li>
<p>Store the results within the Cursor instance as a local variable</p>
</li>
</ul>
</li>
<li>
<p>execute()和executemany（）:对数据库执行一个或者多个SQL命令（The SQLite library actually allows us to skip creating a Cursor altogether by using the execute method within the Connection object itself，SQLite will create a Cursor instance for us under the hood and run our query against the database, allowing us to skip a step.）</p>
</li>
<li>
<p>fetchone()、fetchmany()、fetchmany(n)：Cusor method（ Fetch the full results set as a list of tuples）</p>
</li>
</ul>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sqlite3
con <span class="token operator">=</span> sqlite3<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'example.db'</span><span class="token punctuation">)</span>
cur <span class="token operator">=</span> con<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Create table</span>
cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token triple-quoted-string string">'''CREATE TABLE stocks
               (date text, trans text, symbol text, qty real, price real)'''</span><span class="token punctuation">)</span>

<span class="token comment"># Insert a row of data</span>
cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"INSERT INTO stocks VALUES ('2006-01-05','BUY','RHAT',100,35.14)"</span><span class="token punctuation">)</span>

<span class="token comment"># Save (commit) the changes</span>
con<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># We can also close the connection if we are done with it.</span>
<span class="token comment"># Just be sure any changes have been committed or they will be lost.</span>
con<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'SELECT * FROM stocks ORDER BY price'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
<span class="token comment">#在不使用时，记得关闭打开的游标和连接</span>
cur<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
con<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1>MySQL</h1>
<p><img src="../md_imgs/SQL/17.png" alt="image.png"></p>
<h1>SQLAlchemy</h1>
<p>SQLAlchemy是python中用来消除不同数据库语言差异的一个库，虽然不在标准库当中，但是被广泛认可，使用者众多。<br>
SQLAlchemy不需要导入驱动程序，初始化的连接字符串会做出分配，例如：<br>
<code>dialect + driver :// user : password @ host : port / dbnam</code></p>
<ul>
<li>
<p>dialect: the type of db</p>
</li>
<li>
<p>driver:特殊驱动程序</p>
</li>
<li>
<p>host/port:数据服务器的位置(只有特定情况下会使用端口号port)</p>
</li>
<li>
<p>dbname:连接到的数据库名字，可以/开头表示绝对路径</p>
</li>
</ul>
<p><img src="../md_imgs/SQL/18.png" alt="image.png"><br>
以内置的sqlite为例，省略host、port等参数（引擎层）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sqlalchemy <span class="token keyword">as</span> sa
conn<span class="token operator">=</span>sa<span class="token punctuation">.</span>create_engine<span class="token punctuation">(</span><span class="token string">'sqlite:///:memory:'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="sql表达式语言">SQL表达式语言</h2>
<p>除了基础的SQL表达式语言以外，sqlalchemy还提供了多种SQL操作的函数，这种函数调用能解决不同sql语言之间的差异，对于关系型数据库应用是一种中间型方案。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> mysqlx <span class="token keyword">import</span> Column
<span class="token keyword">import</span> sqlalchemy <span class="token keyword">as</span> sa
conn<span class="token operator">=</span>sa<span class="token punctuation">.</span>create_engine<span class="token punctuation">(</span><span class="token string">'sqlite:///Mydb1'</span><span class="token punctuation">)</span>
<span class="token comment">#创建表格</span>
meta<span class="token operator">=</span>sa<span class="token punctuation">.</span>MetaData<span class="token punctuation">(</span><span class="token punctuation">)</span>
Stu_info<span class="token operator">=</span>sa<span class="token punctuation">.</span>Table<span class="token punctuation">(</span><span class="token string">'Stu_info'</span><span class="token punctuation">,</span>meta<span class="token punctuation">,</span>
              sa<span class="token punctuation">.</span>Column<span class="token punctuation">(</span><span class="token string">'Student Name'</span><span class="token punctuation">,</span>sa<span class="token punctuation">.</span>String<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              sa<span class="token punctuation">.</span>Column<span class="token punctuation">(</span><span class="token string">'Student Age'</span><span class="token punctuation">,</span>sa<span class="token punctuation">.</span>INT<span class="token punctuation">)</span>
              <span class="token punctuation">)</span>
meta<span class="token punctuation">.</span>create_all<span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
<span class="token comment">#插入数据</span>
conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>Stu_info<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>Stu_info<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"xiaohong"</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#select all</span>
result<span class="token operator">=</span>conn<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>Stu_info<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
rows<span class="token operator">=</span>result<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="对象关系映射">对象关系映射</h2>
<p>除了通过定义好的SQL函数来处理数据库,sqlalchemy还提供了对象关系映射(ORM)来使用SQL表达式语言,隐藏了实际数据库的机制,通过自己定义的对象,ORM负责处理如何对数据库进行相关处理.有点类似于本土化处理，让操作数据的方式与python更加接近！</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sqlalchemy <span class="token keyword">as</span> sa
<span class="token keyword">from</span> sqlalchemy<span class="token punctuation">.</span>ext<span class="token punctuation">.</span>declarative <span class="token keyword">import</span> declarative_base
<span class="token comment">#连接数据库</span>
conn<span class="token operator">=</span>sa<span class="token punctuation">.</span>create_engine<span class="token punctuation">(</span><span class="token string">'sqlite:///Mydb.db'</span><span class="token punctuation">)</span>
Base<span class="token operator">=</span>declarative_base<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Stu_info</span><span class="token punctuation">(</span>Base<span class="token punctuation">)</span><span class="token punctuation">:</span>
    __tablename__<span class="token operator">=</span><span class="token string">'stu_info'</span>
    name<span class="token operator">=</span>sa<span class="token punctuation">.</span>Column<span class="token punctuation">(</span><span class="token string">'Student Name'</span><span class="token punctuation">,</span>sa<span class="token punctuation">.</span>String<span class="token punctuation">,</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    age<span class="token operator">=</span>sa<span class="token punctuation">.</span>Column<span class="token punctuation">(</span><span class="token string">'Student Age'</span><span class="token punctuation">,</span>sa<span class="token punctuation">.</span>INT<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>name<span class="token operator">=</span>name
        self<span class="token punctuation">.</span>age<span class="token operator">=</span>age
    <span class="token keyword">def</span> <span class="token function">__str__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"&lt;Stu_info(&#123;&#125;,&#123;&#125;)>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">,</span>self<span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token comment">#创建数据库和表单</span>
Base<span class="token punctuation">.</span>metadata<span class="token punctuation">.</span>create_all<span class="token punctuation">(</span>conn<span class="token punctuation">)</span>
first<span class="token operator">=</span>Stu_info<span class="token punctuation">(</span><span class="token string">"xiaoming"</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span>
second<span class="token operator">=</span>Stu_info<span class="token punctuation">(</span><span class="token string">"xiaohong"</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span>
<span class="token comment">#将创建的数据写入数据库</span>
Session<span class="token operator">=</span>sa<span class="token punctuation">.</span>orm<span class="token punctuation">.</span>sessionmaker<span class="token punctuation">(</span>bind<span class="token operator">=</span>conn<span class="token punctuation">)</span>
session<span class="token operator">=</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>first<span class="token punctuation">)</span>
session<span class="token punctuation">.</span>add<span class="token punctuation">(</span>second<span class="token punctuation">)</span>
<span class="token comment">#session.add_all([first,second])</span>
session<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>三个层级属于sqlalchemy不同的用法</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://kebuaaa.github.io">可不</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://kebuaaa.github.io/SQL/">https://kebuaaa.github.io/SQL/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://kebuaaa.github.io" target="_blank">小明的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="../tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a><a class="post-meta__tags" href="../tags/SQL/">SQL</a><a class="post-meta__tags" href="../tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="../Scrapy%E6%A1%86%E6%9E%B6/"><img class="prev-cover" src="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600" onerror="onerror=null;src='https://images.pexels.com/photos/374918/pexels-photo-374918.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Scrapy框架</div></div></a></div><div class="next-post pull-right"><a href="../Seaborn%E5%BA%93%E7%AE%80%E4%BB%8B/"><img class="next-cover" src="https://images.pexels.com/photos/768125/pexels-photo-768125.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600" onerror="onerror=null;src='https://images.pexels.com/photos/374918/pexels-photo-374918.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Seaborn库简介</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="../Data%20Visualization/" title="Data Visualization"><img class="cover" src="https://images.pexels.com/photos/768125/pexels-photo-768125.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">Data Visualization</div></div></a></div><div><a href="../Matplotlib%E5%BA%93/" title="Matplotlib库"><img class="cover" src="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">Matplotlib库</div></div></a></div><div><a href="../Numpy%EF%BC%88numerical%20%20Python%EF%BC%89/" title="Numpy（numerical  Python）"><img class="cover" src="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">Numpy（numerical  Python）</div></div></a></div><div><a href="../Pandas/" title="Pandas"><img class="cover" src="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">Pandas</div></div></a></div><div><a href="../Seaborn%E5%BA%93%E7%AE%80%E4%BB%8B/" title="Seaborn库简介"><img class="cover" src="https://images.pexels.com/photos/768125/pexels-photo-768125.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">Seaborn库简介</div></div></a></div><div><a href="../%E4%BA%A7%E7%94%9F%E5%92%8C%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86/" title="产生和加载数据集"><img class="cover" src="https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&cs=tinysrgb&w=600" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-26</div><div class="title">产生和加载数据集</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">SQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">基本书写规则</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.</span> <span class="toc-text">表的创建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%88%A0%E9%99%A4%E5%92%8C%E6%9B%B4%E6%96%B0"><span class="toc-number">2.2.</span> <span class="toc-text">表的删除和更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E5%88%A0%E9%99%A4%EF%BC%9A"><span class="toc-number">2.2.1.</span> <span class="toc-text">表的删除：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E4%BF%AE%E6%94%B9-alter-table-%EF%BC%9A"><span class="toc-number">2.2.2.</span> <span class="toc-text">表的修改（ALTER TABLE）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E7%9A%84%E6%B8%85%E7%A9%BA"><span class="toc-number">2.2.3.</span> <span class="toc-text">表的清空</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">2.2.4.</span> <span class="toc-text">插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="toc-number">2.2.5.</span> <span class="toc-text">数据的更新</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">extract data from databases</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%90%E7%AE%97%E4%B8%8E%E6%AF%94%E8%BE%83"><span class="toc-number">3.1.</span> <span class="toc-text">数据运算与比较</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">常用的计算函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E4%B8%8E%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97"><span class="toc-number">3.1.2.</span> <span class="toc-text">算术运算与比较运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="toc-number">3.1.3.</span> <span class="toc-text">逻辑运算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.</span> <span class="toc-text">字符串函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%A8%A1%E7%B3%8A%E5%8C%B9%E9%85%8D-like%E5%AD%97%E5%8F%A5"><span class="toc-number">3.3.</span> <span class="toc-text">字符串的模糊匹配（LIKE字句）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%88%97"><span class="toc-number">3.4.</span> <span class="toc-text">创建新的列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84"><span class="toc-number">3.5.</span> <span class="toc-text">分组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8F%96%E5%88%86%E7%BB%84%E5%90%8E%E7%9A%84%E9%83%A8%E5%88%86%E6%95%B0%E6%8D%AE"><span class="toc-number">3.5.1.</span> <span class="toc-text">提取分组后的部分数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#subquery-complex-and-dynamic-queries"><span class="toc-number">3.6.</span> <span class="toc-text">subquery（complex and dynamic queries）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="toc-number">3.6.1.</span> <span class="toc-text">集合运算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#combining-colums-with-joining"><span class="toc-number">3.7.</span> <span class="toc-text">Combining Colums with Joining</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inner-join"><span class="toc-number">3.7.1.</span> <span class="toc-text">Inner Join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#left-join"><span class="toc-number">3.7.2.</span> <span class="toc-text">Left Join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#right-join"><span class="toc-number">3.7.3.</span> <span class="toc-text">RIGHT JOIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#full-join"><span class="toc-number">3.7.4.</span> <span class="toc-text">FULL JOIN</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#self-join"><span class="toc-number">3.7.5.</span> <span class="toc-text">Self-join</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#joining-for-many-tables"><span class="toc-number">3.8.</span> <span class="toc-text">Joining for many tables</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#combining-rows-with-union"><span class="toc-number">3.9.</span> <span class="toc-text">Combining Rows with UNION</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#thinking-in-sql"><span class="toc-number">3.10.</span> <span class="toc-text">Thinking in SQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#philosophy-of-writting-sql"><span class="toc-number">3.11.</span> <span class="toc-text">philosophy of writting SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A3%E4%B8%80%E4%B8%AAsubquery"><span class="toc-number">3.11.1.</span> <span class="toc-text">指代一个subquery</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#with%E4%B8%B4%E6%97%B6%E6%8C%87%E4%BB%A3"><span class="toc-number">3.11.1.1.</span> <span class="toc-text">with临时指代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#create-view%E6%B0%B8%E4%B9%85%E6%8C%87%E4%BB%A3"><span class="toc-number">3.11.1.2.</span> <span class="toc-text">CREATE VIEW永久指代</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">窗口函数(Online Anallytical Processing)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%92%8Cgroup-order%E7%9A%84%E5%8C%BA%E5%88%AB-%E5%A5%BD%E5%A4%84"><span class="toc-number">4.1.</span> <span class="toc-text">和group,order的区别(好处)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">interact with a SQLite database in Python</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlite-shell"><span class="toc-number">5.1.</span> <span class="toc-text">Sqlite Shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlite3"><span class="toc-number">5.2.</span> <span class="toc-text">sqlite3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">SQLAlchemy</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80"><span class="toc-number">7.1.</span> <span class="toc-text">SQL表达式语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%85%B3%E7%B3%BB%E6%98%A0%E5%B0%84"><span class="toc-number">7.2.</span> <span class="toc-text">对象关系映射</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://images.pexels.com/photos/317355/pexels-photo-317355.jpeg?auto=compress&amp;cs=tinysrgb&amp;w=600')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 可不</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="../js/utils.js"></script><script src="../js/main.js"></script><script src="../js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'c7GEX67zIq8BwxrCJCcnCNGJ-gzGzoHsz',
      appKey: 'sMi0vKwORQNhvze51vwvkmep',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script src="/js/snowflake.js"></script><script src="/js/beijing.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>